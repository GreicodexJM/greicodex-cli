{{ if eq .Stack.ci "Bitbucket Pipelines" }}
image: node:18

pipelines:
  default:
    - step:
        script:
          - npm install
          - npm run lint
          - npm test -- --watch=false --browsers=ChromeHeadless
          - curl -L https://github.com/zricethezav/gitleaks/releases/download/v8.15.2/gitleaks_8.15.2_linux_x64.tar.gz -o gitleaks.tar.gz
          - tar -xzf gitleaks.tar.gz
          - ./gitleaks detect --source . --verbose
{{ end }}
